//
//  ManDocumentControllerTests.m
//  ManOpenTests
//
//  Created by Don McCaughey on 2/10/18.
//

#import <XCTest/XCTest.h>
#import "ManDocumentController.h"


@interface ManDocumentControllerTests : XCTestCase

@property (retain) ManDocumentController *controller;

@end


@implementation ManDocumentControllerTests

#pragma mark - EscapePath

- (void)testEscapePath
{
    XCTAssertEqualObjects(@"", EscapePath(@"", NO));
    XCTAssertEqualObjects(@"''", EscapePath(@"", YES));

    XCTAssertEqualObjects(@"'\\''", EscapePath(@"'", NO));
    XCTAssertEqualObjects(@"''\\'''", EscapePath(@"'", YES));
    
    XCTAssertEqualObjects(@"/foo/bar", EscapePath(@"/foo/bar", NO));
    XCTAssertEqualObjects(@"'/foo/bar'", EscapePath(@"/foo/bar", YES));

    XCTAssertEqualObjects(@"/foo bar/baz", EscapePath(@"/foo bar/baz", NO));
    XCTAssertEqualObjects(@"'/foo bar/baz'", EscapePath(@"/foo bar/baz", YES));

    XCTAssertEqualObjects(@"/Apple'\\''s Stuff", EscapePath(@"/Apple's Stuff", NO));
    XCTAssertEqualObjects(@"'/Apple'\\''s Stuff'", EscapePath(@"/Apple's Stuff", YES));

    XCTAssertEqualObjects(@"/foo/'\\''bar'\\''", EscapePath(@"/foo/'bar'", NO));
    XCTAssertEqualObjects(@"'/foo/'\\''bar'\\'''", EscapePath(@"/foo/'bar'", YES));

    XCTAssertEqualObjects(@"'\\''foo'\\''/bar", EscapePath(@"'foo'/bar", NO));
    XCTAssertEqualObjects(@"''\\''foo'\\''/bar'", EscapePath(@"'foo'/bar", YES));
}

#pragma mark - manCommandWithManPath

- (void)testManCommandWithManPath
{
    XCTAssertEqualObjects(@"/usr/bin/man",
                          [_controller manCommandWithManPath:nil]);
    XCTAssertEqualObjects(@"/usr/bin/man",
                          [_controller manCommandWithManPath:@""]);
    XCTAssertEqualObjects(@"/usr/bin/man -M '/usr/man'",
                          [_controller manCommandWithManPath:@"/usr/man"]);
    XCTAssertEqualObjects(@"/usr/bin/man -M '/usr/man:/it'\\''s great'",
                          [_controller manCommandWithManPath:@"/usr/man:/it's great"]);
}

#pragma mark - setUp

- (void)setUp
{
    [super setUp];
    _controller = [ManDocumentController sharedDocumentController];
}

@end
